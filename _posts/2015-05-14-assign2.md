---
layout: post
title: Assignment IIâ€”Mesh Simplification
---
This is the writeup for the second assignment of `CSE 190`. Data structure is everything in this project, so in the beginning, I will briefly summarize my analysis of mesh simplification problem and explain the reason why I choose these structures. After that, I will post up the results from single test models to the large complex ones. At last, I will mention two main bugs which I spent most of the time dealing with.

## Analysis

### General 

Using `indexed face set` with `vertex to face adjacency table` is quite straight forward: `openGL` drawing function only concerns about *faces* and *vertices*. And we can not gain much benefit if we introduce *edges* in `edge collapse` process. However we have to do write down every step in details before we choose the specific structure.

### Edge Collapse

In an `edge collapse` procedure, we need to:

1. Find two points **v0**, **v1** in the vertices set. Remove these two vertives and insert a new vertex **v**
2. Find all the faces adjacent to **v0**, **v1**
3. Change all **v0**, **v1** in the adjacent faces to **v**
4. Remove the common faces of **v0**, **v1**
5. Insert **v** in adjacency table and update the adjacency table for the vertices adjacent to **v0**, **v1**. And remove **v0**, **v1**

Beside that, for illustration, we have to update *vertices normals* and *face colors* properly.

### Quadric Simplification

The structure in this section is simple. We need a *Q matrices* structure, which is basically the same as *vertices normals*. In addition, there must be a structure for ordered edges. The total procedure would be like:

1. Find least cost edge **e** = (**v0**, **v1**)
2. Do edge collapse with **v0**, **v1**
3. Remove **v0**, **v1** in Q matrices and add **v0**
4. Remove **e**, update cost of edges of all vertices adjacent to **v0**, **v1**
5. Re-order edges

### Structures and Operations

In sum, we need the date structures to do following operations:

| Structure        | Contents              | Operations                      |
| :---:            | :--:                  | :---:                           |
| Vertices         | (x,y,z) coordinate(3) | Look up; Insert; Remove         |
| Faces            | vertices index(3)     | Look up; Update; Remove         |
| V2F Adjacency    | faces index(N)        | Look up; Update; Insert; Remove |
| Vertices Normals | normal value(1)       | Look up; Update; Insert; Remove |
| Face Colors      | color value(3)        | Look up; Remove                 |
| Q matrices       | Q value(4*4)          | Look up; Insert; Remove         |
| Edges            | cost(1) and vertices index(3)              | Look up; Update; Insert; Remove; sort                               |
    
    The Number between parenthesis denotes the dimension of each element in its structure. For example, in Face Colors structure, there will be **RGB** three value. In Faces structure, as I store all of faces adjacent to one vertex, I don't know the number beforehand, so it is a unknown number N. 

The structure above is complete for implementing mesh simplification. Vertices to vertices adjacency can be obtained with Vertices to Faces adjacency and Faces structure.

### Tricks:

In fact, we don't need to traverse for all the structure relate to vertices.
(We have to do that in faces, as we draw for each face)
Therefore, for those 'vertices' structures, we can drop remove operation. For example, for Vertices structure, we can just make **v** take the place of **v0**. The same trick can be also used for Vertices Normals.

### My Structure:





## Data Structure






